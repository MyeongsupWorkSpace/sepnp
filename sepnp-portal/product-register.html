<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>제품 등록</title>
  <link rel="stylesheet" href="assets/nav.css">
  <style>
  /* 컴팩트 + 한 줄 유지 */
  :root{ --ctl-h:28px; --ctl-r:6px; --ctl-fs:13px }
  .inp,.sel,textarea{ height:var(--ctl-h); padding:6px 8px; font-size:var(--ctl-fs); border-radius:var(--ctl-r) }
  .btn{ height:var(--ctl-h); padding:0 10px; font-size:var(--ctl-fs); border-radius:var(--ctl-r) }
  .card{ padding:12px }
  .title{ margin-bottom:8px }
  .row{ margin:4px 0; gap:8px; grid-template-columns:78px 1fr } /* 라벨 더 좁게 */

  /* 거래처: 버튼을 우측에 딱 붙게 */
  .nowrap{ display:flex; align-items:center; gap:6px; flex-wrap:nowrap; white-space:nowrap }
  #prodVendor{ flex:1; min-width:0 } /* 줄바꿈 방지 */
  #btnVendorManage{ width:56px }      /* 고정폭 */

  /* 치수 한 줄(더 컴팩트) */
  .dim-group{ display:flex; align-items:center; gap:6px; flex-wrap:nowrap; white-space:nowrap }
  .dim{ position:relative }
  .dim .inp{ width:74px; padding-right:24px } /* 입력 폭 더 줄임 */
  .dim .unit{ position:absolute; right:8px; top:50%; transform:translateY(-50%); color:#6b7280; font-size:12px }
  .sep{ margin:0 2px; color:#9aa1a9; font-weight:700 }

  /* 선택 박스 최소폭 축소 */
  #prodPaperType,#prodLaminateType{ min-width:120px }

  /* 상단 3열 동일 높이 */
  .grid.top3{ grid-template-columns:repeat(3,minmax(0,1fr)); align-items:stretch; gap:10px }
  .grid.top3 > *{ height:100% }
  /* 한 줄 치수 입력 너비 축소 */
  .dim .inp{ width:90px; padding-right:28px }
  .sep{ margin:0 2px }
  /* 선택 박스 최소 너비 축소 */
  #prodPaperType,#prodLaminateType{ min-width:130px }
  :root{ --bd:#e5e7eb; --fg:#111; --mut:#6b7280; --bg:#f5f6f8; --card:#fff; --primary:#2563eb; }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",Arial,sans-serif}
  .container{max-width:1200px;margin:24px auto;padding:0 16px}
  h2{margin:0 0 14px;font-size:22px;font-weight:800}
  .topbar{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-bottom:10px}
  .btn{height:36px;padding:0 14px;border:1px solid var(--bd);border-radius:8px;background:#fff;cursor:pointer}
  .btn:hover{background:#f3f4f6}
  .btn.primary{background:var(--primary);border-color:var(--primary);color:#fff}
  .grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}
  @media(max-width:1100px){ .grid{grid-template-columns:1fr} }
  .card{background:var(--card);border:1px solid var(--bd);border-radius:12px;padding:16px}
  .title{font-weight:700;margin-bottom:10px}
  .row{display:grid;grid-template-columns:96px 1fr;gap:10px;align-items:center;margin:8px 0}
  .row-inline{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .inp,.sel,textarea{height:36px;border:1px solid var(--bd);border-radius:8px;background:#fff;font-size:14px}
  .inp,textarea{padding:8px 10px}
  .sel{padding:0 10px}
  .mini{font-size:12px;color:var(--mut)}
  ul.clean{list-style:none;padding:0;margin:0} ul.clean li{padding:8px 10px;border:1px solid #eef2f5;border-radius:8px;margin:6px 0;background:#fff}
  /* 모달 */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
  .modal.show{display:flex}
  .modal .panel{background:#fff;border:1px solid var(--bd);border-radius:12px;width:min(560px,100%);padding:16px}
  .is-disabled{opacity:.6;pointer-events:none}
  /* 추가 스타일 */
  .dim-group{ display:flex; align-items:center; gap:8px; flex-wrap:nowrap; white-space:nowrap }
  .dim-group > *{ flex:0 0 auto }
  .dim .inp{ width:100px; padding-right:34px } /* 단위 자리 */
  .sep{ margin:0 4px; color:#9aa1a9; font-weight:700 }
  /* 균등 3칸 라인 */
  .line3{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; align-items:center }
  .cell .mini{ display:block; margin-bottom:6px; color:#6b7280; font-size:12px }
  .nowrap{ display:flex; align-items:center; gap:6px; white-space:nowrap; flex-wrap:nowrap }
  .cell .sel{ min-width:160px }
  .cell .btn{ width:32px; padding:0 }
  /* 규격/크기 입력 한 줄 */
  .dim-group{ display:flex; align-items:center; gap:6px; white-space:nowrap }
  .dim{ position:relative }
  .dim .inp{ width:74px; padding-right:24px }
  .dim .unit{ position:absolute; right:8px; top:50%; transform:translateY(-50%); color:#6b7280; font-size:12px }
  .sep{ margin:0 2px; color:#9aa1a9; font-weight:700 }
  @media(max-width:560px){ .dim .inp{ width:96px } }

  /* 치수 입력 공통 너비 변수 */
  :root{ --dimw: 74px; }
  /* 기존 .dim .inp가 있다면 너비를 변수로 교체 */
  .dim .inp{ width:var(--dimw); padding-right:24px } /* ← 기존 width 값을 var(--dimw)로 */
  /* 규격 서브라벨 */
  .dim-wrap{ display:inline-flex; flex-direction:column }
  .dim-sub{ display:flex; gap:6px; margin-top:2px; color:#9aa1a9; font-size:11px; line-height:1 }
  .dim-sub span{ display:inline-block; width:var(--dimw); text-align:center }

  /* 규격 한 줄: [입력]mm × [입력]mm × [입력]mm */
  .dim-group{ display:flex; align-items:center; gap:8px; white-space:nowrap }
  .dim{ display:inline-flex; align-items:center; gap:6px }
  .br{ color:#6b7280; font-weight:600 }   /* 대괄호 스타일 */
  .sep{ color:#9aa1a9; font-weight:700 }
  .inp{ height:28px }                      /* 기존 높이 대비 컴팩트 */
  .dim .inp{ width:74px; padding:6px 8px } /* 장/폭/고 입력 폭 */

  /* 라벨 위, 입력 아래(세로 쌓기) */
  .row.stack{ grid-template-columns:1fr; align-items:flex-start }
  .row.stack > label{ margin-bottom:4px }

  /* 규격: 섹션 폭 안에서 자동 축소/줄바꿈 */
  :root{
    --dimw-min: 60px;   /* 너무 좁아지지 않게 최소 폭 */
    --dimw-max: 74px;   /* 보통 상태 폭 */
  }
  .row.stack{ grid-template-columns: 1fr; align-items:flex-start } /* 라벨 위, 입력 아래 */
  #prodForm .dim-group{
    display:flex; align-items:center; gap:6px;
    flex-wrap:wrap;           /* 넘치면 다음 줄로 */
    max-width:100%;
  }
  .dim .inp{
    width:clamp(var(--dimw-min), 8vw, var(--dimw-max)); /* 화면/섹션 폭에 따라 유연하게 */
    padding:6px 8px;
  }

  /* 용지 정보 3칸: 섹션 폭 안에서 동일 높이/폭 */
  .line3{ display:grid; grid-template-columns:repeat(3, minmax(0,1fr)); gap:10px; align-items:start }
  .line3 .cell{ min-width:0 }         /* 그리드 셀 내부 넘침 방지 */
  .line3 .cell .sel{ width:100%; min-width:0 } /* 셀 안에서 꽉 차되 넘치지 않게 */
  .line3 .cell .btn{ width:32px; padding:0 }
  /* 없음 + 셀렉트 + + 버튼을 셀 폭 안에 정렬 */
  .line3 .cell .nowrap{ display:grid; grid-template-columns:auto 1fr auto; gap:6px; align-items:center; white-space:normal }

  /* 규격: 라벨 아래 한 줄, 절대 줄바꿈 금지 */
  .dim-compact{ display:flex; align-items:center; gap:8px; white-space:nowrap; flex-wrap:nowrap }
  .dim-compact .inp{ width:64px; height:26px; padding:4px 6px; font-size:12px } /* 더 작게 */
  .dim-compact .unit{ font-size:12px; color:#6b7280 }
  .dim-compact .sep{ margin:0 6px; color:#9aa1a9; font-weight:700 }

  /* 용지/합지 셀렉트 너비 동일화 */
  :root { --selectW: 180px; } /* 필요시 숫자만 조정 */
  #prodPaperType,
  #prodLaminateType {
    width: var(--selectW);
    min-width: var(--selectW);
    max-width: var(--selectW);
  }
  /* + 버튼도 통일(옵션) */
  #btnAddPaper,
  #btnAddLaminate { width: 32px; padding: 0; }
  </style>
</head>
<body>
  <header class="fixed-header"></header>

  <main class="container">
    <div class="topbar">
      <h2>제품 등록</h2>
      <div class="row-inline">
        <button type="button" id="clearProducts" class="btn">전체삭제</button>
        <button form="prodForm" type="submit" class="btn primary">등록</button>
      </div>
    </div>

    <!-- 상단 3열 -->
    <div class="grid top3">
      <!-- 기본 정보 -->
      <form id="prodForm" class="card" style="margin:0">
        <div class="title">기본 정보</div>

        <div class="row">
          <label>거래처</label>
          <div class="nowrap">
            <input id="prodVendor" class="inp" placeholder="거래처 검색 또는 입력" readonly>
            <button type="button" id="btnVendorManage" class="btn">선택</button>
          </div>
        </div>

        <div class="row">
          <label>제품명</label>
          <input id="prodName" class="inp" placeholder="제품명">
        </div>

        <div class="row stack">
          <label>규격</label>
          <div class="dim-compact">
            <input id="prodLength" class="inp" type="number" placeholder="장"><span class="unit">mm</span>
            <span class="sep">×</span>
            <input id="prodWidth"  class="inp" type="number" placeholder="폭"><span class="unit">mm</span>
            <span class="sep">×</span>
            <input id="prodHeight" class="inp" type="number" placeholder="고"><span class="unit">mm</span>
          </div>
        </div>
      </form>

      <!-- 용지 정보 -->
      <section class="card">
        <div class="title">용지 정보</div>

        <div class="row">
          <label>용지</label>
          <div class="row-inline" style="flex:1">
            <select id="prodPaperType" class="sel" style="min-width:160px"><option value="">용지 선택</option></select>
            <button type="button" id="btnAddPaper" class="btn">+</button>
          </div>
        </div>

        <div class="row">
          <label>용지 크기</label>
          <div class="dim-group">
            <div class="dim"><input id="prodPaperWidth"  class="inp" type="number" placeholder="가로"><span class="unit">mm</span></div>
            <span class="sep">×</span>
            <div class="dim"><input id="prodPaperHeight" class="inp" type="number" placeholder="세로"><span class="unit">mm</span></div>
          </div>
        </div>

        <div class="row">
          <label>합지</label>
          <div class="row-inline">
            <label class="row-inline"><input type="checkbox" id="lamNone" style="margin-right:6px">없음</label>
          </div>
        </div>

        <div class="row" id="laminateRow">
          <label>합지 원단</label>
          <div class="row-inline" style="flex:1">
            <select id="prodLaminateType" class="sel" style="min-width:140px"><option value="">합지 선택</option></select>
            <button type="button" id="btnAddLaminate" class="btn">+</button>
          </div>
        </div>

        <div class="row">
          <label>원단 크기</label>
          <div class="dim-group">
            <div class="dim"><input id="prodLamWidth"  class="inp" type="number" placeholder="가로"><span class="unit">mm</span></div>
            <span class="sep">×</span>
            <div class="dim"><input id="prodLamHeight" class="inp" type="number" placeholder="세로"><span class="unit">mm</span></div>
          </div>
        </div>
      </section>

      <!-- 추가정보 -->
      <section class="card">
        <div class="title">추가정보</div>

        <div class="row">
          <label>단가</label>
          <div class="nowrap">
            <input id="prodPrice" class="inp" placeholder="숫자" style="width:140px">
            <span class="mini">원</span>
          </div>
        </div>

        <div class="row">
          <label>절수</label>
          <input id="prodCutCount" class="inp" type="number" placeholder="절수" style="width:120px">
        </div>

        <div class="row">
          <label>칼규격</label>
          <div class="dim-group">
            <div class="dim"><input id="prodKnifeWidth"  class="inp" type="number" placeholder="가로"><span class="unit">mm</span></div>
            <span class="sep">×</span>
            <div class="dim"><input id="prodKnifeHeight" class="inp" type="number" placeholder="세로"><span class="unit">mm</span></div>
          </div>
        </div>

        <div class="row">
          <label>배송지</label>
          <!-- 한 줄 → 2줄로 변경 -->
          <textarea id="prodShipping" class="inp" rows="2"
            placeholder="배송지 입력(상세 주소 포함)"
            style="height:calc(var(--ctl-h) * 2 + 8px)"></textarea>
        </div>

        <!-- 담당자: 휴대폰을 이름 아래로 분리 -->
        <div class="row">
          <label>담당자</label>
          <input id="prodManager" class="inp" placeholder="이름" style="width:140px">
        </div>
        <div class="row">
          <label>휴대폰</label>
          <input id="prodManagerPhone" class="inp" placeholder="010-0000-0000" style="width:180px">
        </div>
      </section>
    </div>

    <!-- 하단 2열 -->
    <div class="grid" style="grid-template-columns:1fr 1fr;margin-top:14px">
      <!-- 공정정보 -->
      <section class="card" id="processSection">
        <div class="title">공정정보</div>
        <div class="row" style="grid-template-columns:96px 1fr">
          <label>공정 선택</label>
          <div class="row-inline" style="flex-wrap:wrap">
            <label><input type="checkbox" name="process" value="인쇄"> 인쇄</label>
            <label><input type="checkbox" name="process" value="코팅"> 코팅</label>
            <label><input type="checkbox" name="process" value="금박"> 금박</label>
            <label><input type="checkbox" name="process" value="형압"> 형압</label>
            <label><input type="checkbox" name="process" value="합지"> 합지</label>
            <label><input type="checkbox" name="process" value="톰슨"> 톰슨</label>
            <label><input type="checkbox" name="process" value="접착"> 접착</label>
          </div>
        </div>

        <div class="row">
          <label>상세</label>
          <div id="processDetail" style="display:none"></div>
        </div>
      </section>

      <!-- 공정 요약 -->
      <section class="card">
        <div class="title">공정 요약</div>
        <ul id="processSummaryList" class="clean">
          <li class="mini">등록된 공정이 없습니다.</li>
        </ul>
      </section>
    </div>
  </main>

  <!-- 거래처 선택 모달 -->
  <div id="vendorModal" class="modal" aria-hidden="true">
    <div class="panel">
      <div class="row">
        <label>검색</label>
        <input id="vendorSearch" class="inp" placeholder="거래처 검색">
      </div>
      <div id="vendorListArea" style="max-height:260px;overflow:auto;border:1px solid #eef1f4;border-radius:8px;padding:8px"></div>
      <div class="row-inline" style="justify-content:flex-end;margin-top:10px;gap:8px">
        <button type="button" id="btnVendorAdd" class="btn">추가</button>
        <button type="button" id="btnVendorUpdate" class="btn">수정</button>
        <button type="button" id="btnVendorDelete" class="btn">삭제</button>
        <div style="flex:1"></div>
        <button type="button" id="btnVendorComplete" class="btn primary">완료</button>
        <button type="button" id="btnVendorClose" class="btn">닫기</button>
      </div>
    </div>
  </div>

  <script src="assets/nav.js"></script>
  <script defer src="assets/product-register.js"></script>
</body>
</html>